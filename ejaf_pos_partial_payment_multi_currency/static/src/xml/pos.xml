<?xml version="1.0" encoding="UTF-8"?>
<templates id="template" xml:space="preserve">

    <t t-extend="OrderReceipt">
<!--        <t t-jquery="t[t-foreach='paymentlines'] div" t-operation="append">-->
<!--            <t t-if="order.currency and line.payment_method.currency_id and order.currency.id != line.payment_method.currency_id[0]">-->
<!--                <span>[<t t-esc='widget.format_return_currency(line.get_amount())'/>]  </span>-->
<!--            </t>-->
<!--        </t>-->
        <t t-jquery=".receipt-change" t-operation="before">
            <t t-if="order.get_due() &gt; 0">
                <br/>
                <div>
                    Due
                    <span t-esc='widget.format_currency(order.get_due())' class="pos-receipt-right-align"/>
                </div>
                <br/>
            </t>
        </t>
        <t t-jquery=".receipt-change" t-operation="replace">
            <div class="pos-receipt-amount receipt-change">
                CHANGE
                <span t-esc='widget.format_return_currency(receipt.change)' class="pos-receipt-right-align"/>
            </div>
        </t>
    </t>

    <t t-extend="PaymentScreen-Paymentlines">
        <t t-jquery="table.paymentlines" t-operation="replace">
             <table class='paymentlines'>
                <colgroup>
                    <col class='due' />
                    <col class='tendered' />
                    <col class='change' />
                    <col class='method' />
                    <col class='controls' />
                </colgroup>
                <thead>
                    <tr class='label'>
                        <th>Due</th>
                        <th>Tendered</th>
                        <th>Change</th>
                        <th>Method</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    <t t-foreach='paymentlines' t-as='line'>
                        <t t-if='line.selected'>
                            <tr class='paymentline selected'>
                                <td class='col-due'>
                                    <t t-if="order.currency.id == line.payment_method.currency_id[0]">
                                        <t t-esc='widget.format_currency_no_symbol(order.get_due(line))' />
                                    </t>
                                    <t t-else="">
                                        <t t-esc='widget.format_currency_no_symbol(order.get_due_currency(line))' />
                                    </t>
                                </td>
                                <t t-if="line &amp;&amp; line.payment_status &amp;&amp; ['done', 'waitingCard', 'waiting', 'reversing', 'reversed'].includes(line.payment_status)">
                                    <td class='col-tendered'>
                                        <t t-if="order.currency.id == line.payment_method.currency_id[0]">
                                            <t t-esc='widget.format_currency_no_symbol(line.get_amount())' />
                                        </t>
                                        <t t-else="">
                                            <t t-esc='widget.format_currency_no_symbol(line.get_amount_currency())' />
                                        </t>
                                    </td>
                                </t>
                                <t t-else="">
                                    <td class='col-tendered edit'>
                                        <t t-esc='widget.inputbuffer' />
                                    </td>
                                </t>
                                <t t-if='order.get_change(line)'>
                                    <td class='col-change highlight' >
<!--                                        <t t-if="order.currency.id == line.payment_method.currency_id[0]">-->
                                        <t t-esc='widget.format_currency_no_symbol(order.get_change(line))' />
<!--                                        </t>-->
<!--                                        <t t-else="">-->
<!--                                            <t t-esc='widget.format_currency_no_symbol(order.get_change_currency(line))' />-->
<!--                                        </t>-->

                                    </td>
                                </t>
                                <t t-if='!order.get_change(line)'>
                                    <td class='col-change' ></td>
                                </t>

                                <td class='col-name' > <t t-esc='line.payment_method.name' /> </td>
                                <t t-if="line &amp;&amp; line.payment_status &amp;&amp; ['done', 'reversed', 'reversing'].includes(line.payment_status)">
                                    <td/>
                                </t>
                                <t t-else=''>
                                    <td class='delete-button' t-att-data-cid='line.cid' aria-label="Delete" title="Delete">
                                        <i class='fa fa-times-circle'/>
                                    </td>
                                </t>

                                <t t-if="line &amp;&amp; line.payment_status">
                                    <t t-call="PaymentScreenElectronicPayment"/>
                                </t>
                            </tr>
                        </t>
                        <t t-if='!line.selected'>
                            <tr class='paymentline' t-att-data-cid='line.cid'>
                                <td class='col-due'>
                                    <t t-if="order.currency.id == line.payment_method.currency_id[0]">
                                        <t t-esc='widget.format_currency_no_symbol(order.get_due(line))' />
                                    </t>
                                    <t t-else="">
                                        <t t-esc='widget.format_currency_no_symbol(order.get_due_currency(line))' />
                                    </t>
                                </td>
                                <td class='col-tendered'>
                                    <t t-if="order.currency.id == line.payment_method.currency_id[0]">
                                        <t t-esc='widget.format_currency_no_symbol(line.get_amount())' />
                                    </t>
                                    <t t-else="">
                                        <t t-esc='widget.format_currency_no_symbol(line.get_amount_currency())' />
                                    </t>
                                </td>
                                <td class='col-change'>
                                    <t t-if='order.get_change(line)'>
<!--                                        <t t-if="order.currency.id == line.payment_method.currency_id[0]">-->
                                        <t t-esc='widget.format_currency_no_symbol(order.get_change(line))' />
<!--                                        </t>-->
<!--                                        <t t-else="">-->
<!--                                            <t t-esc='widget.format_currency_no_symbol(order.get_change_currency(line))' />-->
<!--                                        </t>-->
                                     </t>
                                </td>
                                <td class='col-name'> <t t-esc='line.name' /> </td>
                                <t t-if="line &amp;&amp; line.payment_status &amp;&amp; ['done', 'reversed', 'reversing'].includes(line.payment_status)">
                                    <td/>
                                </t>
                                <t t-else=''>
                                    <td class='delete-button' t-att-data-cid='line.cid' aria-label="Delete" title="Delete">
                                        <i class='fa fa-times-circle'/>
                                    </td>
                                </t>
                            </tr>
                        </t>
                    </t>
                    <t t-if='extradue'>
                        <tr class='paymentline extra' t-att-data-cid='0'>
                            <td class='col-due'><t t-esc='widget.format_currency_no_symbol(extradue)' /> </td>
                        </tr>
                    </t>
                </tbody>
            </table>
        </t>
        <t t-jquery=".paymentline.extra" t-operation="after">
            <td style="font-size: 20px; color: blue;" t-if="extradue &lt; 0 and order.currency and order.amount_return_currency and order.currency.id != order.amount_return_currency.id" class='col-due'><b><t t-esc='widget.format_return_currency(order.get_change())'/></b></td>
        </t>
    </t>

</templates>
