<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <template id="report_arabic_purchaseorder">

        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <t t-call="uruk_reports_layout.arabic_external_layout">
                    <style type="text/css">

                        @font-face {
                        font-family: 'Sans_Arabic';
                        src: local('Sans_Arabic'), local('Sans_Arabic'),
                        url(/uruk_reports_layout/static/fonts/uruk-fonts/Neo_Sans_Arabic_Regular.ttf) format('truetype');
                        }

                        * {
                        font-family: Sans_Arabic !important;
                        
                        }
                    </style>

                    <style>
                    .vl {
                    position: absolute;
                    top: 0px;
                    left: 800px;
                    border-left: 2px solid #e5e5e6;;
                    height: 1000px;
                    }
                    </style>

                    <div class="vl"/>

                    <t t-set="address">
                        <div t-field="doc.partner_id" t-options="{&quot;widget&quot;: &quot;contact&quot;, &quot;fields&quot;: [&quot;address&quot;, &quot;name&quot;], &quot;no_marker&quot;: True}"/>
                        <p t-if="doc.partner_id.vat">
                            <t t-esc="doc.company_id.country_id.vat_label or 'Tax ID'"/>
:
                            <span t-field="doc.partner_id.vat"/>
                        </p>
                    </t>
                    <div class="page" style="padding-right:200px">
                        <div class="oe_structure"/>

                        <h2 class="mt16 text-right">
                            <span t-field="doc.name"/>
                            <span t-if="doc.state not in ['draft','cancel']">أمر شراء #</span>
                            <span t-if="doc.state == 'draft'">">طلب عرض سعر #</span>
                            <span t-if="doc.state == 'cancel'">أمر شراء ملغي #</span>
                        </h2>
                        <br/>

                        <div class="row text-right">
                            <div class="col-4">
                                <strong>:رقم الإشارة الخاص بك</strong>
                                <p t-field="doc.partner_ref" class="m-0"/>
                            </div>
                            <div class="col-4">
                                <strong>:تاريخ الأمر</strong>
                                <p t-field="doc.date_order" class="m-0"/>
                            </div>
                            <div class="col-4">
                                <strong>:مندوب الشراء</strong>
                                <p t-field="doc.user_id" class="m-0"/>
                            </div>
                        </div>
                        <br></br>
                        <table class="table table-sm o_main_table text-right">
                            <thead>
                                <tr>
                                    <th class="text-right">الاجمالي</th>
                                    <th class="text-right">سعر الوحدة</th>
                                    <th class="text-right">الكمية</th>
                                    <th class="text-right">تاريخ الطلب</th>
                                    <th class="text-right">الضرائب</th>
                                    <th class="text-right">الوصف</th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-set="current_subtotal" t-value="0"/>
                                <t t-foreach="doc.order_line" t-as="line">
                                    <t t-set="current_subtotal" t-value="current_subtotal + line.price_subtotal" groups="account.group_show_line_subtotals_tax_excluded"/>
                                    <t t-set="current_subtotal" t-value="current_subtotal + line.price_total" groups="account.group_show_line_subtotals_tax_included"/>

                                    <tr t-att-class="'bg-200 font-weight-bold o_line_section' if line.display_type == 'line_section' else 'font-italic o_line_note' if line.display_type == 'line_note' else ''">
                                        <t t-if="not line.display_type">
                                            <td class="text-right">
                                                <span t-field="line.price_subtotal" t-options='{"widget": "monetary", "display_currency": doc.currency_id}'/>
                                            </td>
                                            <td class="text-right">
                                                <span t-field="line.price_unit"/>
                                            </td>
                                            <td class="text-right" t-if="doc.company_id.is_not_decimal_accuracy">
                                                <span t-esc="round(line.product_qty)"/>
                                                <span t-field="line.product_uom.name" groups="uom.group_uom"/>
                                            </td>
                                            <td class="text-right" t-else="">
                                                <span t-field="line.product_qty"/>
                                                <span t-field="line.product_uom.name" groups="uom.group_uom"/>
                                            </td>
                                            <td class="text-right">
                                                <span t-field="line.date_planned"/>
                                            </td>
                                            <td>
                                                <span t-esc="', '.join(map(lambda x: x.name, line.taxes_id))"/>
                                            </td>
                                            <td id="product">
                                                <span t-field="line.name"/>
                                            </td>

                                        </t>
                                        <t t-if="line.display_type == 'line_section'">
                                            <td colspan="99" id="section">
                                                <span t-field="line.name"/>
                                            </td>
                                            <t t-set="current_section" t-value="line"/>
                                            <t t-set="current_subtotal" t-value="0"/>
                                        </t>
                                        <t t-if="line.display_type == 'line_note'">
                                            <td colspan="99" id="note">
                                                <span t-field="line.name"/>
                                            </td>
                                        </t>
                                    </tr>
                                    <t t-if="current_section and (line_last or doc.order_line[line_index+1].display_type == 'line_section')">
                                        <tr class="is-subtotal text-right">
                                            <td colspan="99" id="subtotal">
                                                <strong class="mr16">Subtotal</strong>
                                                <span t-esc="current_subtotal" t-options='{"widget": "monetary", "display_currency": doc.currency_id}'
                                                />
</td>
</tr>
</t>
</t>
</tbody>
</table>
<div id="total" class="row">
                                                    <div class="col-4  text-right">
                                                        <table class="table table-sm">
                                                            <tr class="border-black">
                                                                <td class="text-right">
                                                                    <span t-field="doc.amount_untaxed" t-options='{"widget": "monetary", "display_currency": doc.currency_id}'/>
                                                                </td>
                                                                <td>
                                                                    <strong>الاجمالي الفرعي</strong>
                                                                </td>

                                                            </tr>
                                                            <tr>
                                                                <td class="text-right">
                                                                    <span t-field="doc.amount_tax" t-options='{"widget": "monetary", "display_currency": doc.currency_id}'/>
                                                                </td>
                                                                <td>الضرائب</td>
                                                            </tr>
                                                            <tr class="border-black o_total">

                                                                <td class="text-right">
                                                                    <span t-field="doc.amount_total" t-options='{"widget": "monetary", "display_currency": doc.currency_id}'/>
                                                                </td>
                                                                <td>
                                                                    <strong>الاجمالي</strong>
                                                                </td>
                                                            </tr>
                                                        </table>
                                                    </div>
                                                </div>

                                                <p t-field="doc.notes"/>
                                                <div class="oe_structure"/>
                                            </div>
                                        </t>
                                    </t>
                                </t>
                            </template>

                            <report id="purchase_arabic_print" string="أمر شراء" model="purchase.order" report_type="qweb-pdf" name="uruk_reports_layout.report_arabic_purchaseorder" file="uruk_reports_layout.report_arabic_purchaseorder" print_report_name="'Purchase - %s' % (object.name).replace('/', '')" />
                        </odoo>